<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Sergio - Completo</title>
    <style>
        /* ===== CSS Variables ===== */
        :root {
            --color-primary: #1d1d1d;
            --color-secondary: #333;
            --color-text: #1d1d1d;
            --color-text-secondary: #666;
            --color-text-tertiary: #999;
            --color-bg: #f5f5f7;
            --color-bg-alt: white;
            --color-border: #e5e5e7;
            --color-success: #34c759;
            --color-success-dark: #30b24f;
            --color-danger: #ff6b6b;
            --color-info: #0369a1;
            --color-info-bg: #f0f9ff;
            --color-info-border: #bfdbfe;
            --color-warning: #92400e;
            --color-warning-bg: #fef3c7;
            --color-warning-border: #fcd34d;
            --spacing-xs: 8px;
            --spacing-sm: 12px;
            --spacing-md: 16px;
            --spacing-lg: 20px;
            --spacing-xl: 25px;
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --font-size-sm: 12px;
            --font-size-base: 13px;
            --font-size-md: 14px;
            --font-size-lg: 15px;
            --font-size-xl: 22px;
            --font-size-2xl: 24px;
            --font-size-3xl: 28px;
            --transition: all 0.2s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
        }

        body {
            font-family: var(--font-family);
            background: var(--color-bg);
            min-height: 100vh;
            padding: var(--spacing-xs);
            color: var(--color-text);
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: var(--color-text);
            margin-bottom: var(--spacing-xl);
            padding: var(--spacing-lg) 0;
        }

        header h1 {
            font-size: var(--font-size-3xl);
            font-weight: 700;
            margin-bottom: var(--spacing-xs);
            letter-spacing: -0.5px;
        }

        header p {
            font-size: var(--font-size-base);
            color: var(--color-text-secondary);
            font-weight: 400;
        }

        .nav-tabs {
            display: flex;
            gap: var(--spacing-xs);
            overflow-x: auto;
            margin-bottom: var(--spacing-xl);
            padding: 0;
            background: transparent;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .nav-tabs::-webkit-scrollbar {
            display: none;
        }

        .nav-tab {
            padding: var(--spacing-xs) 14px;
            background: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 500;
            color: var(--color-text-secondary);
            font-size: var(--font-size-base);
            transition: var(--transition);
            white-space: nowrap;
            flex-shrink: 0;
        }

        .nav-tab:hover {
            background: var(--color-bg);
            color: var(--color-text);
        }

        .nav-tab.active {
            background: var(--color-primary);
            color: var(--color-bg-alt);
            border-color: var(--color-primary);
        }

        .section {
            background: var(--color-bg-alt);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            display: none;
            animation: fadeIn 0.2s ease;
            border: 1px solid var(--color-border);
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(400px); opacity: 0; }
        }

        h1, h2, h3, h4 {
            color: var(--color-text);
            font-weight: 600;
            margin-bottom: var(--spacing-md);
        }

        h1 {
            font-size: var(--font-size-3xl);
        }

        h2 {
            font-size: var(--font-size-xl);
            border-bottom: 1px solid var(--color-border);
            padding-bottom: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        h3 {
            font-size: var(--font-size-lg);
            margin-top: var(--spacing-lg);
        }

        h4 {
            font-size: var(--font-size-md);
        }

        p {
            line-height: 1.5;
            color: var(--color-text-secondary);
            margin-bottom: var(--spacing-sm);
            font-size: var(--font-size-md);
        }

        ul, ol {
            margin-left: 20px;
            margin-bottom: var(--spacing-sm);
        }

        li {
            margin-bottom: var(--spacing-xs);
            line-height: 1.5;
            font-size: var(--font-size-md);
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xl);
        }

        .metric-card {
            background: var(--color-bg);
            color: var(--color-text);
            padding: 18px;
            border-radius: var(--radius-lg);
            text-align: center;
            border: 1px solid var(--color-border);
            transition: var(--transition);
        }

        .metric-card:hover {
            border-color: var(--color-primary);
        }

        .metric-card .value {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            margin: var(--spacing-xs) 0;
        }

        .metric-card > div:first-child {
            font-size: var(--font-size-base);
            color: var(--color-text-secondary);
        }

        .metric-card > div:last-child {
            font-size: var(--font-size-base);
            color: var(--color-text-secondary);
        }

        .checklist {
            background: var(--color-bg);
            padding: 0;
            border-radius: var(--radius-md);
            margin-bottom: var(--spacing-lg);
            overflow: hidden;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            background: var(--color-bg-alt);
            border-bottom: 1px solid var(--color-border);
        }

        .checklist-item:last-child {
            border-bottom: none;
        }

        .checklist-item input[type="checkbox"],
        .checklist-item input[type="radio"] {
            margin-right: var(--spacing-sm);
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--color-primary);
            border-radius: var(--radius-sm);
            flex-shrink: 0;
        }

        .checklist-item label {
            flex: 1;
            cursor: pointer;
            margin: 0;
            font-size: var(--font-size-md);
            font-weight: 500;
        }

        .time-block {
            background: var(--color-bg);
            padding: 14px 16px;
            border-radius: var(--radius-md);
            margin-bottom: 10px;
            border-left: 3px solid var(--color-primary);
        }

        .time-block strong {
            color: var(--color-text);
            font-weight: 600;
            font-size: var(--font-size-md);
        }

        .time-block em {
            color: var(--color-text-secondary);
            display: block;
            margin-top: 4px;
            font-size: var(--font-size-base);
            font-style: normal;
        }

        .btn {
            display: inline-block;
            background: var(--color-primary);
            color: var(--color-bg-alt);
            padding: 10px 20px;
            border-radius: var(--radius-md);
            border: none;
            cursor: pointer;
            font-weight: 500;
            margin: var(--spacing-xs) 5px var(--spacing-xs) 0;
            transition: var(--transition);
            font-size: var(--font-size-md);
            font-family: inherit;
        }

        .btn:hover {
            background: var(--color-secondary);
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .alert {
            background: var(--color-info-bg);
            border: 1px solid var(--color-info-border);
            color: var(--color-info);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            margin-bottom: var(--spacing-lg);
            font-size: var(--font-size-base);
            line-height: 1.5;
        }

        .alert-warning {
            background: var(--color-warning-bg);
            border-color: var(--color-warning-border);
            color: var(--color-warning);
        }

        code {
            background: var(--color-bg);
            padding: 2px 6px;
            border-radius: var(--radius-sm);
            font-family: 'Menlo', monospace;
            font-size: var(--font-size-sm);
        }

        pre {
            background: var(--color-bg);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            overflow-x: auto;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-sm);
        }

        .grid-2-auto {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-xs);
        }

        .card {
            background: var(--color-bg);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            border: 1px solid var(--color-border);
        }

        .card h4 {
            margin-bottom: var(--spacing-md);
        }

        footer {
            text-align: center;
            color: var(--color-text-tertiary);
            padding: var(--spacing-xl) 0 var(--spacing-lg);
            margin-top: 40px;
            font-size: var(--font-size-sm);
            line-height: 1.5;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: var(--font-size-2xl);
            }

            .section {
                padding: var(--spacing-lg);
            }

            .nav-tabs {
                margin-bottom: var(--spacing-lg);
            }

            .grid-2, .grid-2-auto {
                grid-template-columns: 1fr;
            }

            .grid-3 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .tracker-input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            margin-bottom: 10px;
            font-size: var(--font-size-md);
            font-family: inherit;
        }

        .save-btn {
            background: var(--color-success);
        }

        .save-btn:hover {
            background: var(--color-success-dark);
        }

        .checklist-label {
            display: flex;
            flex-direction: column;
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--color-primary);
            color: var(--color-bg-alt);
            padding: var(--spacing-sm) 16px;
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            z-index: 9999;
            animation: slideIn 0.3s ease;
        }

        .metric-card-large {
            cursor: pointer;
            border: 2px solid var(--color-border);
            transition: var(--transition);
        }

        .metric-card-large:hover {
            border-color: var(--color-primary);
            background: #efefef;
        }

        .metric-card-large.active {
            background: #d4edda;
            border-color: #34c759;
        }

        .progress-bar-container {
            background: var(--color-bg-alt);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid var(--color-border);
        }

        .progress-bar {
            background: var(--color-success);
            height: 100%;
            transition: width 0.3s ease;
        }

        .review-card {
            background: var(--color-bg);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            border-left: 4px solid var(--color-primary);
            margin-bottom: var(--spacing-sm);
        }

        .week-history-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: var(--spacing-xs);
        }

        .week-history-item {
            border-radius: var(--radius-md);
            padding: 10px 5px;
            text-align: center;
            font-size: var(--font-size-sm);
            border: 1px solid var(--color-border);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--spacing-sm);
        }

        .calendar-card {
            background: var(--color-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .calendar-card.today {
            border-color: var(--color-primary);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04);
        }

        .calendar-card h4 {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: var(--font-size-md);
        }

        .calendar-tag {
            background: #eef2ff;
            color: #4338ca;
            padding: 2px 8px;
            border-radius: 999px;
            font-size: var(--font-size-sm);
        }

        .calendar-plan-item {
            display: flex;
            gap: 8px;
            align-items: center;
            font-size: var(--font-size-md);
            color: var(--color-text-secondary);
        }

        .calendar-status {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            font-size: var(--font-size-sm);
        }

        .calendar-status div {
            background: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            padding: 6px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ Sistema Sergio 2026</h1>
            <p style="color: white; margin-top: 10px;">Tu plan personalizado de mejora ‚Ä¢ Todo en una p√°gina</p>
        </header>

        <div class="nav-tabs" id="navTabs">
            <button class="nav-tab active" onclick="showSection('tracker-diario', this)">üìç Hoy</button>
            <button class="nav-tab" onclick="showSection('calendario', this)">üóìÔ∏è Calendario</button>
            <button class="nav-tab" onclick="showSection('dashboard', this)">üìä Dashboard</button>
            <button class="nav-tab" onclick="showSection('semana1', this)">üöÄ Semana 1</button>
            <button class="nav-tab" onclick="showSection('sueno', this)">üò¥ Protocolo Sue√±o</button>
            <button class="nav-tab" onclick="showSection('pomodoro', this)">‚ö° Pomodoro</button>
            <button class="nav-tab" onclick="showSection('ejercicio', this)">üèãÔ∏è Ejercicio</button>
            <button class="nav-tab" onclick="showSection('rutina', this)">üåÖ Rutina</button>
            <button class="nav-tab" onclick="showSection('tracker-metricas', this)">üìä Tracker</button>
            <button class="nav-tab" onclick="showSection('revision', this)">üìã Revisi√≥n</button>
        </div>

        <!-- CALENDARIO SEMANAL -->
        <div id="calendario" class="section">
            <h2>üóìÔ∏è Calendario semanal</h2>
            <p>Lo que toca cada d√≠a y el registro real de la semana en curso.</p>

            <div class="alert" id="calendarWeekRange" style="margin-bottom: 16px;">
                Cargando semana...
            </div>

            <div class="calendar-grid" id="calendarContainer"></div>

            <div class="alert" style="margin-top: 16px;">
                Leyenda: ‚úÖ completado ‚Ä¢ ‚ùå pendiente ‚Ä¢ üî• pomodoros reales ‚Ä¢ Meta: 12 pomodoros, 7-8h sue√±o, ejercicio L-M-V.
            </div>
        </div>

        <!-- DASHBOARD -->
        <div id="dashboard" class="section">
            <h2>üìä Dashboard - Sistema Sergio</h2>

            <div class="metric-grid">
                <div class="metric-card">
                    <div>üí™ Ejercicio</div>
                    <div class="value">120 min</div>
                    <div>3 sesiones/semana</div>
                </div>
                <div class="metric-card">
                    <div>‚ö° Pomodoros</div>
                    <div class="value">12-15</div>
                    <div>Diarios de enfoque</div>
                </div>
                <div class="metric-card">
                    <div>üò¥ Sue√±o</div>
                    <div class="value">7-8 h</div>
                    <div>Cada noche</div>
                </div>
            </div>

            <div class="alert" id="todayAlert">
                <strong>‚úÖ HOY (17 Enero - S√ÅBADO):</strong> Disfruta del tiempo libre. Prepara tu espacio de trabajo, descarga apps, planifica la semana.
            </div>

            <h3>üéØ ¬øC√≥mo empiezas?</h3>
            <div class="grid-2">
                <div class="card">
                    <h4>1Ô∏è‚É£ Lee HOY</h4>
                    <p>Semana 1 Plan + Protocolo Sue√±o (50 min)</p>
                    <button class="btn" onclick="showSection('semana1')">Leer Semana 1</button>
                </div>
                <div class="card">
                    <h4>2Ô∏è‚É£ Prepara</h4>
                    <p>Apps (Be Focused) + Habitaci√≥n + Equipo (45 min)</p>
                    <button class="btn" onclick="showSection('sueno')">Leer Sue√±o</button>
                </div>
                <div class="card">
                    <h4>3Ô∏è‚É£ Ma√±ana 07:15h</h4>
                    <p>Despierta y empieza rutina matinal</p>
                    <button class="btn" onclick="showSection('rutina')">Leer Rutina</button>
                </div>
            </div>

            <h3>üìö Todos los m√≥dulos</h3>
            <p>Usa el men√∫ de arriba para acceder a cada secci√≥n completa del sistema.</p>

            <h3>‚òÅÔ∏è Sincronizaci√≥n</h3>
            <div class="grid-2">
                <button class="btn" onclick="createShareLink()" style="background: #007AFF; width: 100%;">
                    üîó Copiar Link Compartible
                </button>
                <button class="btn" onclick="downloadBackup()" style="background: #34c759; width: 100%;">
                    üì• Descargar Backup
                </button>
                <button class="btn" onclick="uploadBackup()" style="background: #ff9500; width: 100%;">
                    üì§ Restaurar Backup
                </button>
            </div>
            <p style="font-size: 12px; color: #999; margin-top: 12px;">
                <strong>Link:</strong> Copia el link y √∫salo en otro dispositivo para sincronizar autom√°ticamente.<br>
                <strong>Backup:</strong> Descarga/restaura tu archivo de datos.
            </p>
        </div>

        <!-- SEMANA 1 -->
        <div id="semana1" class="section">
            <h2>üöÄ COMIENZA MA√ëANA - Plan 7 D√≠as</h2>

            <h3>‚è∞ HOY (17 Enero)</h3>
            <div class="checklist">
                <div class="checklist-item">
                    <input type="checkbox">
                    <label>üì± Descargar app "Be Focused" o "Forest"</label>
                </div>
                <div class="checklist-item">
                    <input type="checkbox">
                    <label>üõèÔ∏è Compra persiana oscura (‚Ç¨20-50) O cinta negra</label>
                </div>
                <div class="checklist-item">
                    <input type="checkbox">
                    <label>üõèÔ∏è Reorganiza cama (lado derecho, almohada firme)</label>
                </div>
                <div class="checklist-item">
                    <input type="checkbox">
                    <label>üìñ Lee este documento (20 min)</label>
                </div>
            </div>

            <h3>üìÖ MA√ëANA - Lunes 18 Enero</h3>

            <div class="time-block">
                <strong>07:15 - Rutina ma√±ana (20 min)</strong>
                <em>Agua + lim√≥n (5 min) ‚Üí Blinkist (10 min) ‚Üí Desayuno (5 min)</em>
            </div>

            <div class="time-block">
                <strong>09:00-18:30 - Trabajo con Pomodoros</strong>
                <em>15 min enfoque + 3 min break. Meta: 12 Pomodoros/d√≠a</em>
            </div>

            <div class="time-block">
                <strong>18:30-19:15 - Ejercicio (40 min)</strong>
                <em>Calentamiento 5 min ‚Üí Ejercicio 30 min ‚Üí Estiramiento 5 min</em>
            </div>

            <div class="time-block">
                <strong>21:00-21:30 - Rutina noche</strong>
                <em>Estiramiento hombros (3 min) ‚Üí Respiraci√≥n 4-7-8 ‚Üí Duermes</em>
            </div>

            <h3>üéØ OBJETIVO SEMANA 1</h3>
            <ul>
                <li><strong>Ejercicio:</strong> 3 sesiones √ó 40 min = 120 min ‚úì</li>
                <li><strong>Pomodoros:</strong> 12-14 por d√≠a laboral = 60+ total ‚úì</li>
                <li><strong>Sue√±o:</strong> 7-8 horas todas las noches ‚úì</li>
            </ul>

            <h3>‚ùå QU√â NO HAGAS SEMANA 1</h3>
            <ul>
                <li>NO intentes Nivel 2 ejercicio (demasiado duro)</li>
                <li>NO hagas 20 Pomodoros (agotador, burn out)</li>
                <li>NO cambies todo a la vez (solo 3 cosas)</li>
                <li>NO seas perfeccionista (si falta 1 cosa = NO ES FRACASO)</li>
            </ul>
        </div>

        <!-- PROTOCOLO SUE√ëO -->
        <div id="sueno" class="section">
            <h2>üò¥ Protocolo de Sue√±o & Hombros - CR√çTICO</h2>

            <div class="alert alert-warning">
                <strong>‚ö†Ô∏è CR√çTICO:</strong> Duerme bien = Base de TODO. Sin sue√±o, todo lo dem√°s falla.
            </div>

            <h3>üõèÔ∏è POSTURA CORRECTA EN CAMA</h3>
            <p><strong>El Problema:</strong> Duermes en postura que tensa hombros 8 horas = Dolor + Ansiedad + Sue√±o pobre</p>

            <div class="card">
                <h4>Postura Correcta (Lado Derecho)</h4>
                <ul>
                    <li>Cabeza en almohada (no muy alta)</li>
                    <li>Cuello RECTO (no girado)</li>
                    <li>Hombro RELAJADO hacia abajo</li>
                    <li>Brazo izquierdo ADELANTE en almohada</li>
                    <li>Cadera/pierna doblada 90¬∞</li>
                </ul>
            </div>

            <h3>üåô AMBIENTE √ìPTIMO</h3>

            <div class="grid-2">
                <div class="card">
                    <h4>1Ô∏è‚É£ OSCURIDAD (CR√çTICO)</h4>
                    <ul>
                        <li>Persiana oscura o cinta negra</li>
                        <li>Sin m√≥vil (pantalla brilla)</li>
                        <li>Oscuridad total 21:30-07:15</li>
                    </ul>
                </div>

                <div class="card">
                    <h4>2Ô∏è‚É£ TEMPERATURA</h4>
                    <ul>
                        <li>Ideal: 16-19¬∞C</li>
                        <li>Si caliente: Abre ventana antes dormir</li>
                        <li>Si fr√≠a: Manta extra</li>
                    </ul>
                </div>

                <div class="card">
                    <h4>3Ô∏è‚É£ SONIDO</h4>
                    <ul>
                        <li>Silencio ideal</li>
                        <li>Si hay ruido: Tapones ‚Ç¨5</li>
                    </ul>
                </div>

                <div class="card">
                    <h4>4Ô∏è‚É£ AROMAS (BONUS)</h4>
                    <ul>
                        <li>Lavanda (pillow spray ‚Ç¨5)</li>
                        <li>Eucalipto (difusor ‚Ç¨10)</li>
                    </ul>
                </div>
            </div>

            <h3>üå¨Ô∏è T√âCNICA: RESPIRACI√ìN 4-7-8</h3>
            <p>Si no duermes despu√©s 10 min en cama:</p>
            <ol>
                <li>Acostado, lado derecho, postura correcta</li>
                <li>Respira por nariz (4 segundos)</li>
                <li>Ret√©n aire (7 segundos)</li>
                <li>Exhala por boca (8 segundos)</li>
                <li>Repite 5 veces</li>
            </ol>

            <h3>üïê RUTINA NOCTURNA (21:00-21:30)</h3>

            <div class="time-block">
                <strong>21:00 - Cena ligera</strong>
                <em>Prote√≠na + carbohidrato. Ejemplo: Pechuga + arroz</em>
            </div>

            <div class="time-block">
                <strong>21:05 - Ducha/higiene</strong>
                <em>Agua templada (no caliente)</em>
            </div>

            <div class="time-block">
                <strong>21:15 - Estiramiento hombros (3 min)</strong>
                <em>Pecho (20 seg), Trapecio (20 seg c/lado), Rotaci√≥n (10 veces)</em>
            </div>

            <div class="time-block">
                <strong>21:25 - Luz OFF</strong>
                <em>Acu√©state en postura, respiraci√≥n 4-7-8</em>
            </div>

            <div class="time-block">
                <strong>21:30 - Dormido (objetivo)</strong>
            </div>

            <h3>üìä EXPECTATIVAS</h3>
            <ul>
                <li><strong>Semana 1:</strong> Postura inc√≥moda, dolor igual/peor (tensi√≥n), sue√±o fr√°gil</li>
                <li><strong>Semana 2:</strong> Postura normal, dolor empieza a mejorar, sue√±o mejor, energ√≠a empieza a subir</li>
                <li><strong>Semana 3-4:</strong> Dolor 50% menos, duermes 7-8h sin problema, energ√≠a NOTABLE</li>
                <li><strong>Mes 2:</strong> Dolor casi desaparece, sue√±o excelente, todo mejora</li>
            </ul>
        </div>

        <!-- POMODORO -->
        <div id="pomodoro" class="section">
            <h2>‚ö° Pomodoro Anti-Distracci√≥n - Sistema Para Ti</h2>

            <div class="alert">
                <strong>Tu realidad:</strong> Max 30 min enfoque. Por eso: 15 min Pomodoro (no 25)
            </div>

            <h3>üü¢ TU SISTEMA: Pomodoro 15 min</h3>

            <div class="card">
                <h4>Estructura</h4>
                <ul>
                    <li>15 min ENFOQUE M√ÅXIMO (tel√©fono lejos)</li>
                    <li>3 min BREAK (caminar, agua, no pantalla)</li>
                    <li>15 min ENFOQUE (otra tarea)</li>
                    <li>3 min BREAK</li>
                    <li>15 min ENFOQUE</li>
                    <li>5 min BREAK LARGO</li>
                </ul>
                <p style="margin-top: 15px;"><strong>Total:</strong> 3 Pomodoros = 45 min trabajo real + 11 min breaks = 56 min sesi√≥n</p>
            </div>

            <h3>üì± HERRAMIENTAS (Elige 1)</h3>

            <div class="grid-2">
                <div class="card">
                    <h4>Be Focused (RECOMENDADO)</h4>
                    <ul>
                        <li>iOS/Android</li>
                        <li>Visual (red circle)</li>
                        <li>Bloquea distracciones</li>
                        <li>Hist√≥rico semanal</li>
                        <li>Gratis versi√≥n b√°sica</li>
                    </ul>
                </div>

                <div class="card">
                    <h4>Forest (M√°s divertida)</h4>
                    <ul>
                        <li>Plantas √°rbol virtual 15 min</li>
                        <li>Si sales app = se muere</li>
                        <li>Psicol√≥gicamente potente</li>
                        <li>‚Ç¨2,99</li>
                    </ul>
                </div>
            </div>

            <h3>üîí BLOQUEOS REALES</h3>

            <div class="card">
                <h4>EN M√ìVIL:</h4>
                <ul>
                    <li>Modo Avi√≥n ON</li>
                    <li>Notificaciones todas OFF</li>
                    <li>M√≥vil EN OTRA HABITACI√ìN o caj√≥n</li>
                    <li>Slack/WhatsApp CERRADO</li>
                </ul>
            </div>

            <div class="card">
                <h4>EN ORDENADOR:</h4>
                <ul>
                    <li>Desconectar WiFi (si puedes)</li>
                    <li>Email CERRADO</li>
                    <li>Redes sociales BLOQUEADAS</li>
                    <li>YouTube BLOQUEADO</li>
                    <li>Chats MINIMIZADOS</li>
                </ul>
            </div>

            <div class="card">
                <h4>EN ENTORNO:</h4>
                <ul>
                    <li>Aud√≠fonos/m√∫sica ON</li>
                    <li>Puerta cerrada</li>
                    <li>Tel√©fono SILENCIADO</li>
                    <li>Postura: Silla buena, monitor altura ojos</li>
                </ul>
            </div>

            <h3>üéØ OBJETIVOS SEMANALES</h3>
            <ul>
                <li><strong>Semana 1:</strong> 10 Pomodoros/d√≠a √ó 5 d√≠as = 50 Pomodoros</li>
                <li><strong>Semana 2:</strong> 12 Pomodoros/d√≠a √ó 5 d√≠as = 60 Pomodoros</li>
                <li><strong>Mes 1:</strong> 15 Pomodoros/d√≠a es normal</li>
            </ul>

            <h3>üö® SI TE DISTRAES</h3>
            <p><strong>Regla: "La Ley de los 2 Minutos"</strong></p>
            <ol>
                <li>Apunta en post-it (no en m√≥vil)</li>
                <li>Sigue 15 min</li>
                <li>En break: Chequea post-it</li>
                <li>Si urgente: Hazlo pr√≥ximo Pomodoro</li>
                <li>Si no urgente: Ignora</li>
            </ol>
            <p style="margin-top: 15px;"><em>Realidad: 99% de "urgencias" no lo son.</em></p>
        </div>

        <!-- EJERCICIO -->
        <div id="ejercicio" class="section">
            <h2>üèãÔ∏è Ejercicio en Casa 40 min</h2>

            <div class="alert">
                <strong>Tienes:</strong> Barra + Paralelas + Goma 15lb = SUFICIENTE
            </div>

            <h3>üìÖ HORARIO RECOMENDADO</h3>
            <p><strong>MEJOR MOMENTO: 18:30-19:15 (Lunes, Mi√©rcoles, Viernes)</strong></p>
            <ul>
                <li>Energ√≠a post-trabajo recuperada</li>
                <li>Cena despu√©s = Recuperaci√≥n + Sue√±o</li>
                <li>Luz natural + Vitamina D</li>
                <li>Rutina consistente = H√°bito</li>
            </ul>

            <h3>üìã RUTINA 40 MINUTOS</h3>

            <div class="card">
                <h4>00-05 min: CALENTAMIENTO</h4>
                <ul>
                    <li>Saltar comba o jumping jacks (1 min)</li>
                    <li>Rotaci√≥n brazos (1 min)</li>
                    <li>Mu√±ecas (20 seg)</li>
                    <li>Caderas (30 seg)</li>
                    <li>Trote en lugar (1 min)</li>
                </ul>
            </div>

            <div class="card">
                <h4>05-25 min: FUERZA SUPERIOR (20 min)</h4>
                <p><strong>Dominadas/Flexiones (6 min):</strong> 4 series √ó 5 reps</p>
                <p><strong>Fondos Paralelas (6 min):</strong> 3 series √ó 5-8 reps</p>
                <p><strong>Goma Resistencia (5 min):</strong> Remo + Press pecho, 2 series cada</p>
            </div>

            <div class="card">
                <h4>25-35 min: FUERZA INFERIOR + CORE (10 min)</h4>
                <p><strong>Planchas (2 min):</strong> 3 √ó 20 seg</p>
                <p><strong>Sentadillas (3 min):</strong> 3 √ó 15 reps</p>
                <p><strong>Abdominales (3 min):</strong> 3 √ó 10 crunches</p>
            </div>

            <div class="card">
                <h4>35-40 min: ESTIRAMIENTO (5 min) - CR√çTICO</h4>
                <p><strong>Pecho (1 min):</strong> Brazos atr√°s, 20 seg √ó 3</p>
                <p><strong>Trapecio (1.5 min):</strong> Inclina cabeza, 20 seg c/lado √ó 2</p>
                <p><strong>Hombro posterior (1.5 min):</strong> Brazo cruza pecho, 20 seg √ó 2</p>
                <p><strong>Rotaci√≥n (1 min):</strong> Brazos colgando, 10 veces lento</p>
            </div>

            <h3>üìà PROGRESI√ìN</h3>
            <ul>
                <li><strong>Semana 1-2 (NIVEL 1):</strong> Completar sin modificar, t√©cnica correcta</li>
                <li><strong>Semana 3-4 (NIVEL 2):</strong> Aumenta 1-2 reps por ejercicio</li>
                <li><strong>Semana 5-6 (NIVEL 2+):</strong> A√±ade 1 serie m√°s</li>
            </ul>

            <h3>‚ö†Ô∏è ERRORES A EVITAR</h3>
            <ul>
                <li>NO empices Nivel 3. Empieza Nivel 1.</li>
                <li>NO entrenes 1 hora. 40 min est√° bien.</li>
                <li>NO entrenes todos los d√≠as. 3 veces/semana.</li>
                <li>NO omitas estiramiento. Los 5 min finales SON CR√çTICOS.</li>
            </ul>
        </div>

        <!-- RUTINA MATINAL -->
        <div id="rutina" class="section">
            <h2>üåÖ Mini-Rutina 7:15h - Solo 20 Minutos</h2>

            <div class="alert">
                <strong>‚ö° Importante:</strong> No es 5 AM. Es REALISTA para ti.
            </div>

            <h3>üéØ Por qu√© 7:15h (no 5 AM)</h3>
            <ul>
                <li>Trabajas 9-18:30h</li>
                <li>5 AM es imposible</li>
                <li>7:15h = Tu ritmo real</li>
                <li>Consistencia > Fantas√≠a</li>
            </ul>

            <h3>‚è∞ ESTRUCTURA 20 MINUTOS</h3>

            <div class="card">
                <h4>BLOQUE 1: Movimiento (5 min) - 07:15-07:20</h4>
                <p><strong>Opci√≥n A (Buen tiempo):</strong> Luz solar directo + Agua con lim√≥n</p>
                <p><strong>Opci√≥n B (Lluvia):</strong> 5 flexiones O 1 min trote O 10 fondos</p>
            </div>

            <div class="card">
                <h4>BLOQUE 2: Lectura (10 min) - 07:20-07:30</h4>
                <p><strong>Tu Herramienta:</strong> Blinkist (15 min summary)</p>
                <p>Elige: Productividad, Fitness, Finanzas, Psicolog√≠a</p>
                <p><strong>Alternativa:</strong> Kindle 10 min lectura</p>
                <p style="color: #dc3545;"><strong>‚ùå NO:</strong> Redes, Email, YouTube, Noticias</p>
            </div>

            <div class="card">
                <h4>BLOQUE 3: Desayuno (5 min) - 07:30-07:35</h4>
                <ul>
                    <li><strong>Prote√≠na:</strong> 2 huevos O lata at√∫n O pechuga fr√≠a</li>
                    <li><strong>Carbohidrato:</strong> Pan integral O cereales avena O arroz</li>
                    <li><strong>Grasa:</strong> Mantequilla O aceite O aguacate</li>
                    <li><strong>Bebida:</strong> Caf√© O t√© + Agua</li>
                </ul>
            </div>

            <h3>üö® VERSI√ìN DE EMERGENCIA (5 min)</h3>
            <p>Si est√°s muy ocupado/cansado:</p>
            <ul>
                <li>Agua con lim√≥n (1 min)</li>
                <li>Blinkist resumen (2 min)</li>
                <li>Caf√© r√°pido (1 min)</li>
                <li>Listo (1 min)</li>
            </ul>
            <p><em>Es mejor 5 min real, que 0 por perfeccionismo</em></p>

            <h3>üìä EXPECTATIVAS SEMANA 1</h3>
            <ul>
                <li><strong>D√≠a 1-2:</strong> Inc√≥modo/raro, pero hazes</li>
                <li><strong>D√≠a 3-5:</strong> Empieza a sentirse normal, energ√≠a sube</li>
                <li><strong>Semana 2:</strong> Se hace solo, energ√≠a consistente, h√°bito formado</li>
            </ul>
        </div>

        <!-- TRACKER 3 M√âTRICAS -->
        <div id="tracker-metricas" class="section">
            <h2>üìä Tracker 3 M√©tricas - S√∫per Simple</h2>

            <div class="alert">
                <strong>Solo 3 cosas importan:</strong> 1) ¬øEjercicio 40+ min? 2) ¬ø10+ Pomodoros? 3) ¬ø7-8h sue√±o?
            </div>

            <h3>‚úÖ DEFINICIONES CLARAS</h3>

            <div class="card">
                <h4>EJERCICIO ‚úì:</h4>
                <ul>
                    <li>40+ minutos continuos</li>
                    <li>Lunes/Mi√©rcoles/Viernes preferible</li>
                    <li>Si 45 min = ‚úì</li>
                    <li>Si 35 min = ‚úó</li>
                </ul>
            </div>

            <div class="card">
                <h4>POMODOROS ‚úì:</h4>
                <ul>
                    <li>10+ Pomodoros completados en el d√≠a</li>
                    <li>Mira app Be Focused al final del d√≠a</li>
                    <li>Si 12 = ‚úì</li>
                    <li>Si 8 = ‚úó</li>
                </ul>
            </div>

            <div class="card">
                <h4>SUE√ëO ‚úì:</h4>
                <ul>
                    <li>7-8 horas dormidas</li>
                    <li>Ejemplo: Duermes 22:30h ‚Üí Despiertas 07:30h</li>
                    <li>Si 7.5 hrs = ‚úì</li>
                    <li>Si 6 hrs = ‚úó</li>
                </ul>
            </div>

            <h3>üéØ OBJETIVOS POR MES</h3>

            <div class="card">
                <h4>ENERO:</h4>
                <ul>
                    <li>Ejercicio: 10-12 sesiones</li>
                    <li>Pomodoros: 700+ total</li>
                    <li>Sue√±o: 210+ horas (7h promedio)</li>
                </ul>
            </div>

            <div class="card">
                <h4>FEBRERO:</h4>
                <ul>
                    <li>Ejercicio: Mismo (consistencia)</li>
                    <li>Pomodoros: 750+</li>
                    <li>Sue√±o: 224+ horas (8h promedio)</li>
                </ul>
            </div>

            <h3>üî¥ REGLAS IMPORTANTES</h3>
            <ul>
                <li><strong>NO hagas 10 m√©tricas.</strong> Solo 3. M√°s = Abrumador = Fallas.</li>
                <li><strong>NO seas perfecto (7/7 d√≠as).</strong> 4-5 d√≠as = ‚úì Excelente.</li>
                <li><strong>NO te rindas un mal d√≠a.</strong> Un d√≠a ‚â† Mala semana. Sigue.</li>
                <li><strong>NO empieces con 5 m√©tricas.</strong> 3 es el n√∫mero m√°gico.</li>
            </ul>

            <h3>üìã TABLA PARA IMPRIMIR O USAR</h3>
            <p>Copia y completa cada d√≠a:</p>
            <pre style="background: #f0f0f0; padding: 15px; border-radius: 6px; overflow-x: auto;">
FECHA | D√çA | EJERCICIO | POMODOROS | SUE√ëO | ‚úì GANASTE?
------|-----|-----------|-----------|-------|--------
      |     | ‚úì/‚úó       | ‚úì/‚úó       | ‚úì/‚úó   | ‚úì/‚úó
      |     | ‚úì/‚úó       | ‚úì/‚úó       | ‚úì/‚úó   | ‚úì/‚úó
            </pre>
        </div>

        <!-- REVISI√ìN SEMANAL -->
        <div id="revision" class="section">
            <h2>üìã Revisi√≥n Semanal 15 min</h2>

            <div style="background: #f5f5f7; border-radius: 12px; padding: 16px; margin-bottom: 20px;">
                <strong>üìÖ Semana actual:</strong>
                <div style="font-size: 14px; color: #666; margin-top: 8px;" id="weekRangeDisplay">Cargando...</div>
            </div>

            <h3>‚ùì Las 3 Preguntas</h3>

            <!-- PREGUNTA 1: EJERCICIO -->
            <div class="checklist" style="margin-bottom: 20px;">
                <div class="checklist-item">
                    <input type="radio" name="exercise" value="si" id="ex-si" onchange="saveWeeklyReview()">
                    <label for="ex-si">‚úÖ S√ç: Hice ejercicio 3√ó esta semana</label>
                </div>
                <div class="checklist-item">
                    <input type="radio" name="exercise" value="casi" id="ex-casi" onchange="saveWeeklyReview()">
                    <label for="ex-casi">‚ö†Ô∏è CASI: 2 d√≠as (pr√≥xima semana prioriza)</label>
                </div>
                <div class="checklist-item">
                    <input type="radio" name="exercise" value="no" id="ex-no" onchange="saveWeeklyReview()">
                    <label for="ex-no">‚ùå NO: Menos de 2 d√≠as (¬øqu√© pas√≥?)</label>
                </div>
            </div>

            <!-- PREGUNTA 2: POMODOROS -->
            <div class="checklist" style="margin-bottom: 20px;">
                <div class="checklist-item">
                    <input type="radio" name="pomodoros" value="si" id="pom-si" onchange="saveWeeklyReview()">
                    <label for="pom-si">‚úÖ S√ç: 10+ Pomodoros/d√≠a laboral (excelente)</label>
                </div>
                <div class="checklist-item">
                    <input type="radio" name="pomodoros" value="parcial" id="pom-parcial" onchange="saveWeeklyReview()">
                    <label for="pom-parcial">‚ö†Ô∏è PARCIAL: 5-9/d√≠a (mejor)</label>
                </div>
                <div class="checklist-item">
                    <input type="radio" name="pomodoros" value="no" id="pom-no" onchange="saveWeeklyReview()">
                    <label for="pom-no">‚ùå NO: 0-4/d√≠a (aumenta bloqueos)</label>
                </div>
            </div>

            <!-- PREGUNTA 3: SUE√ëO -->
            <div class="checklist" style="margin-bottom: 20px;">
                <div class="checklist-item">
                    <input type="radio" name="sleep" value="si" id="sleep-si" onchange="saveWeeklyReview()">
                    <label for="sleep-si">‚úÖ S√ç: 5+ noches de 7-8h (excelente)</label>
                </div>
                <div class="checklist-item">
                    <input type="radio" name="sleep" value="parcial" id="sleep-parcial" onchange="saveWeeklyReview()">
                    <label for="sleep-parcial">‚ö†Ô∏è PARCIAL: 3-4 noches (mejor)</label>
                </div>
                <div class="checklist-item">
                    <input type="radio" name="sleep" value="no" id="sleep-no" onchange="saveWeeklyReview()">
                    <label for="sleep-no">‚ùå CR√çTICO: <3 noches (mejora ambiente)</label>
                </div>
            </div>

            <h3>üìù Notas de la Semana</h3>
            <textarea id="weekNotes" placeholder="¬øQu√© cambios har√°s pr√≥xima semana? Ej: 'Entrenar lunes en vez de viernes'" 
                      style="width: 100%; height: 80px; padding: 12px; border: 1px solid #e5e5e7; border-radius: 8px; font-family: inherit; font-size: 14px; resize: none; margin-bottom: 15px;"
                      onchange="saveWeeklyReview()"></textarea>

            <button class="btn save-btn" onclick="saveWeeklyReview()" style="width: 100%; margin-bottom: 20px;">üíæ Guardar Revisi√≥n</button>

            <h3>üìä Historial de Revisiones</h3>
            <div id="reviewHistoryContainer"></div>

            <h3>üéØ Recomendaciones por M√©trica</h3>
            <div class="card">
                <h4>üí™ Si ejercicio NO va bien:</h4>
                <p>Mant√©n horario fijo (LUN/MI√â/VIE 18:30). Es dif√≠cil romper h√°bito si cambias d√≠as.</p>
            </div>
            <div class="card">
                <h4>‚ö° Si Pomodoros van MAL:</h4>
                <p>Aumenta bloqueos (m√≥vil fuera, WiFi OFF). No es disciplina, es ambiente.</p>
            </div>
            <div class="card">
                <h4>üò¥ Si sue√±o va MAL:</h4>
                <p><strong>PRIORIDAD #1.</strong> Mejora ambiente (oscuridad total) O toma magnesio. Sin sue√±o, todo falla.</p>
            </div>
        </div>

        <!-- TRACKER DIARIO -->
        <div id="tracker-diario" class="section active">
            <h2>üìç Hoy - Tracker</h2>

            <div style="text-align: center; color: #1d1d1d; font-size: 1.1rem; margin-bottom: 25px; font-weight: 600;" id="todayDateDisplay">
                Cargando...
            </div>

            <!-- 3 M√âTRICAS PRINCIPALES -->
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 25px;">
                
                <!-- EJERCICIO -->
                <div style="background: #f5f5f7; border-radius: 12px; padding: 16px; text-align: center; border: 2px solid #e5e5e7; cursor: pointer; transition: all 0.2s;" id="exerciseCard" onclick="toggleMetric('exercise')">
                    <div style="font-size: 32px; margin-bottom: 8px;">üí™</div>
                    <div style="font-size: 13px; color: #666; margin-bottom: 8px;">Ejercicio</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 8px;" id="exerciseDisplay">‚ùå</div>
                    <div style="font-size: 11px; color: #999;">40 min</div>
                </div>

                <!-- POMODOROS -->
                <div style="background: #f5f5f7; border-radius: 12px; padding: 16px; text-align: center; border: 2px solid #e5e5e7;">
                    <div style="font-size: 32px; margin-bottom: 8px;">‚ö°</div>
                    <div style="font-size: 13px; color: #666; margin-bottom: 8px;">Pomodoros</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 8px;" id="pomodoroDisplay">0</div>
                    <div style="display: flex; gap: 6px; justify-content: center; margin-top: 10px;">
                        <button class="btn" style="padding: 6px 10px; font-size: 12px; flex: 1; margin: 0;" onclick="decrementPomodoro()">‚àí</button>
                        <button class="btn" style="padding: 6px 10px; font-size: 12px; flex: 1; margin: 0;" onclick="incrementPomodoro()">+</button>
                    </div>
                </div>

                <!-- SUE√ëO -->
                <div style="background: #f5f5f7; border-radius: 12px; padding: 16px; text-align: center; border: 2px solid #e5e5e7; cursor: pointer; transition: all 0.2s;" id="sleepCard" onclick="toggleMetric('sleep')">
                    <div style="font-size: 32px; margin-bottom: 8px;">üò¥</div>
                    <div style="font-size: 13px; color: #666; margin-bottom: 8px;">Sue√±o</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 8px;" id="sleepDisplay">‚ùå</div>
                    <div style="font-size: 11px; color: #999;">7-8 hrs</div>
                </div>

            </div>

            <!-- BARRAS DE PROGRESO -->
            <div style="background: #f5f5f7; border-radius: 12px; padding: 16px; margin-bottom: 25px;">
                <div style="margin-bottom: 15px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="font-size: 13px; font-weight: 600;">Pomodoros: <span id="pomodoroProgress">0/12</span></span>
                    </div>
                    <div style="background: white; height: 8px; border-radius: 4px; overflow: hidden; border: 1px solid #e5e5e7;">
                        <div id="pomodoroBar" style="background: #34c759; height: 100%; width: 0%; transition: width 0.3s;"></div>
                    </div>
                </div>

                <div style="display: flex; gap: 10px;">
                    <div style="flex: 1;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 5px;">Ejercicio</div>
                        <div style="background: white; height: 6px; border-radius: 3px; overflow: hidden; border: 1px solid #e5e5e7;">
                            <div id="exerciseBar" style="background: #ff6b6b; height: 100%; width: 0%; transition: width 0.3s;"></div>
                        </div>
                    </div>
                    <div style="flex: 1;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 5px;">Sue√±o</div>
                        <div style="background: white; height: 6px; border-radius: 3px; overflow: hidden; border: 1px solid #e5e5e7;">
                            <div id="sleepBar" style="background: #5ac8fa; height: 100%; width: 0%; transition: width 0.3s;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CHECKLIST DEL D√çA -->
            <h3>‚úÖ Checklist Hoy</h3>
            <div class="checklist" id="checklistContainer"></div>

            <!-- HORARIO -->
            <h3 style="margin-top: 25px;">üìÖ Horario</h3>
            <div id="scheduleContainer"></div>

            <!-- INTEGRACI√ìN GOOGLE CALENDAR -->
            <h3 style="margin-top: 25px;">üìÖ A√±adir a Google Calendar</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;">
                <button class="btn" onclick="addToGoogleCalendar('exercise')" style="background: #ff6b6b; width: 100%; margin: 0;">
                    üí™ Ejercicio
                </button>
                <button class="btn" onclick="addToGoogleCalendar('sleep')" style="background: #5ac8fa; width: 100%; margin: 0;">
                    üò¥ Sue√±o
                </button>
                <button class="btn" onclick="addToGoogleCalendar('pomodoro')" style="background: #34c759; width: 100%; margin: 0;">
                    ‚ö° Pomodoros
                </button>
                <button class="btn" onclick="addToGoogleCalendar('routine')" style="background: #ff9500; width: 100%; margin: 0;">
                    üåÖ Rutina
                </button>
            </div>

            <!-- HIST√ìRICO SEMANAL -->
            <h3 style="margin-top: 25px;">üìä √öltimos 7 D√≠as</h3>
            <div id="weekHistoryContainer"></div>

        </div>

        <footer>
            <p>üéØ Sistema Sergio 2026 | Personalizado 100% | Realista y Consistente</p>
            <p style="margin-top: 10px; opacity: 0.8;">Todo en una p√°gina ‚Ä¢ Funciona offline ‚Ä¢ M√≥vil y Ordenador</p>
        </footer>
    </div>

    <script>
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar si hay datos en la URL para cargar
            loadDataFromURL();
            renderCalendarView();
            
            if (document.getElementById('tracker-diario').classList.contains('active')) {
                initTracker();
            }
        });

        function showSection(id, el) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Show selected section
            document.getElementById(id).classList.add('active');

            // Add active class to clicked tab
            if (el) {
                el.classList.add('active');
            }

            // Initialize tracker if needed
            if (id === 'tracker-diario') {
                setTimeout(initTracker, 100);
            }

            if (id === 'calendario') {
                setTimeout(renderCalendarView, 100);
            }
            
            // Load review if needed
            if (id === 'revision') {
                setTimeout(loadWeeklyReview, 100);
            }
        }

        function initTracker() {
            setTodayDate();
            renderChecklist();
            renderSchedule();
            loadProgress();
            renderWeekHistory();
        }

        function renderWeekHistory() {
            const history = getWeekHistory();
            const container = document.getElementById('weekHistoryContainer');
            if (!container) return;

            container.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px;">
                    ${history.map(day => {
                        const hasData = day.data !== null;
                        const exercise = hasData && day.data.exercise;
                        const sleep = hasData && day.data.sleep;
                        const pomodoros = hasData ? day.data.pomodoros : 0;
                        const isComplete = exercise && sleep && pomodoros >= 10;
                        
                        return `
                            <div style="
                                background: ${isComplete ? '#d4edda' : (hasData ? '#fff3cd' : '#f5f5f7')};
                                border: 1px solid ${isComplete ? '#c3e6cb' : (hasData ? '#ffeaa7' : '#e5e5e7')};
                                border-radius: 8px;
                                padding: 10px 5px;
                                text-align: center;
                                font-size: 11px;
                            ">
                                <div style="font-weight: 600; margin-bottom: 5px;">${day.dayName}</div>
                                <div style="font-size: 10px; color: #999; margin-bottom: 5px;">${day.date.split('-')[2]}</div>
                                <div style="font-size: 16px;">
                                    ${exercise ? 'üí™' : '‚ö™'}
                                    ${sleep ? 'üò¥' : '‚ö™'}
                                </div>
                                <div style="font-size: 10px; margin-top: 3px; color: #666;">
                                    ${pomodoros > 0 ? `${pomodoros}üî•` : '-'}
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
                <div style="margin-top: 15px; padding: 12px; background: #f5f5f7; border-radius: 8px; font-size: 12px; color: #666;">
                    <strong>Leyenda:</strong> üí™ Ejercicio ‚Ä¢ üò¥ Sue√±o ‚Ä¢ üî• Pomodoros completados
                </div>
            `;
        }

        function getCurrentWeekDates() {
            const today = new Date();
            const day = today.getDay() === 0 ? 7 : today.getDay();
            const monday = new Date(today);
            monday.setHours(0, 0, 0, 0);
            monday.setDate(today.getDate() - (day - 1));

            const days = [];
            for (let i = 0; i < 7; i++) {
                const d = new Date(monday);
                d.setDate(monday.getDate() + i);
                days.push(d);
            }
            return days;
        }

        function buildDayPlan(date) {
            const day = date.getDay();
            const isWeekend = day === 0 || day === 6;
            const isExerciseDay = day === 1 || day === 3 || day === 5;

            if (isWeekend) {
                return {
                    isWeekend: true,
                    isExerciseDay: false,
                    plan: [
                        { icon: '‚òÄÔ∏è', text: 'Ma√±ana relajada + caf√©' },
                        { icon: 'üéØ', text: day === 0 ? 'Planifica la semana + revisi√≥n' : 'Hobbies / descanso activo' },
                        { icon: 'üèÉ', text: 'Movimiento ligero o paseo' },
                        { icon: 'üò¥', text: 'Dormir 7-8h (21:30)' }
                    ]
                };
            }

            return {
                isWeekend: false,
                isExerciseDay: isExerciseDay,
                plan: [
                    { icon: 'üåÖ', text: '07:15 Rutina matinal (20 min)' },
                    { icon: 'üíº', text: 'Pomodoros meta 12 (09:00-18:30)' },
                    { icon: isExerciseDay ? 'üèãÔ∏è' : 'üö∂', text: isExerciseDay ? '18:30 Ejercicio 40 min' : 'Paseo / estiramientos' },
                    { icon: 'üò¥', text: '21:30 Dormir 7-8h' }
                ]
            };
        }

        function renderCalendarView() {
            const container = document.getElementById('calendarContainer');
            const rangeEl = document.getElementById('calendarWeekRange');
            if (!container || !rangeEl) return;

            const weekDates = getCurrentWeekDates();
            const weekStart = weekDates[0];
            const weekEnd = weekDates[6];

            rangeEl.textContent = `${weekStart.toLocaleDateString('es-ES', { day: '2-digit', month: 'short' })} - ${weekEnd.toLocaleDateString('es-ES', { day: '2-digit', month: 'short' })}`;

            const todayKey = getTodayKey();
            const todayMidnight = new Date(todayKey);
            todayMidnight.setHours(0, 0, 0, 0);

            container.innerHTML = weekDates.map(date => {
                const key = date.toISOString().split('T')[0];
                const stored = localStorage.getItem(`progress_${key}`);
                const progress = stored ? JSON.parse(stored) : null;
                const pomodoros = progress?.pomodoros || 0;
                const exerciseDone = progress ? !!progress.exercise : false;
                const sleepDone = progress ? !!progress.sleep : false;
                const isToday = key === todayKey;
                const isFuture = date > todayMidnight;
                const planData = buildDayPlan(date);

                const exerciseStatus = planData.isExerciseDay
                    ? (exerciseDone ? '‚úÖ' : (isFuture ? 'Meta' : '‚ùå'))
                    : (exerciseDone ? '‚úÖ' : (planData.isWeekend ? 'Desc' : '‚Äî'));

                const sleepStatus = sleepDone ? '‚úÖ' : (isFuture ? 'Meta' : '‚ùå');
                const pomStatus = pomodoros > 0 ? `${pomodoros}/12` : (isFuture ? 'Meta 12' : '0/12');

                return `
                    <div class="calendar-card ${isToday ? 'today' : ''}">
                        <h4>${date.toLocaleDateString('es-ES', { weekday: 'long' }).toUpperCase()} <span class="calendar-tag">${date.toLocaleDateString('es-ES', { day: '2-digit', month: 'short' })}${isToday ? ' ‚Ä¢ HOY' : ''}</span></h4>
                        <div class="calendar-status">
                            <div>üí™ ${exerciseStatus}</div>
                            <div>‚ö° ${pomStatus}</div>
                            <div>üò¥ ${sleepStatus}</div>
                        </div>
                        ${planData.plan.map(item => `<div class="calendar-plan-item"><span>${item.icon}</span><span>${item.text}</span></div>`).join('')}
                    </div>
                `;
            }).join('');
        }

        function setTodayDate() {
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('todayDateDisplay').textContent = today.toLocaleDateString('es-ES', options);
        }

        function renderChecklist() {
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0=DOM, 1=LUN, 2=MAR, 3=MI√â, 4=JUE, 5=VIE, 6=SAB
            const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;

            let dailyChecklist = [];

            if (isWeekend) {
                // S√ÅBADO Y DOMINGO
                const isDomingo = dayOfWeek === 0;
                dailyChecklist = [
                    { id: 'water', text: 'Agua + Luz natural', emoji: 'üíß', time: '07:15' },
                    { id: 'breakfast', text: 'Desayuno relajado', emoji: 'ü•£', time: '08:00' },
                    { id: 'hobby', text: 'Tiempo personal (hobbies)', emoji: 'üéØ', time: '08:30' },
                    { id: 'meal', text: 'Comida completa', emoji: 'üçΩÔ∏è', time: '12:00' },
                    { id: 'exercise', text: 'Ejercicio (opcional)', emoji: 'üèãÔ∏è', time: '17:00' },
                    isDomingo ? 
                        { id: 'planning', text: 'üìã REVISI√ìN SEMANAL (15 min)', emoji: '‚úÖ', time: '17:00' } :
                        { id: 'relax', text: 'Actividad de disfrute', emoji: 'üé¨', time: '15:00' },
                    { id: 'social', text: 'Tiempo con familia/amigos', emoji: 'üë•', time: '18:30' },
                    { id: 'dinner', text: 'Cena', emoji: 'üçΩÔ∏è', time: '20:00' },
                    { id: 'sleep', text: 'Dormir', emoji: 'üò¥', time: '21:30' }
                ];
            } else {
                // LUNES A VIERNES - SIEMPRE MOSTRAR EJERCICIO
                dailyChecklist = [
                    { id: 'water', text: 'Agua con lim√≥n', emoji: 'üíß', time: '07:15' },
                    { id: 'blinkist', text: 'Blinkist lectura', emoji: 'üìñ', time: '07:20' },
                    { id: 'breakfast', text: 'Desayuno completo', emoji: 'ü•£', time: '07:30' },
                    { id: 'work', text: 'Trabajo con Pomodoros', emoji: 'üíº', time: '09:00' },
                    { id: 'exercise', text: 'Ejercicio 40 min (si aplica)', emoji: 'üèãÔ∏è', time: '18:30' },
                    { id: 'dinner', text: 'Cena ligera', emoji: 'üçΩÔ∏è', time: '19:30' },
                    { id: 'stretch', text: 'Estiramiento hombros', emoji: 'üßò', time: '21:15' },
                    { id: 'sleep', text: 'Dormir', emoji: 'üò¥', time: '21:30' }
                ];
            }

            const container = document.getElementById('checklistContainer');
            if (!container) return;

            container.innerHTML = dailyChecklist.map(item => `
                <div class="checklist-item" id="item-${item.id}">
                    <input type="checkbox" id="check-${item.id}" onchange="toggleChecklistItem('${item.id}')">
                    <div style="flex: 1;">
                        <label for="check-${item.id}" class="checklist-label">${item.emoji} ${item.text}</label>
                        <div style="color: #999; font-size: 0.8rem;">${item.time}</div>
                    </div>
                </div>
            `).join('');

            applyChecklistState();
        }

        function getChecklistState() {
            const saved = localStorage.getItem(`checklist_${getTodayKey()}`);
            return saved ? JSON.parse(saved) : {};
        }

        function saveChecklistState(state) {
            localStorage.setItem(`checklist_${getTodayKey()}`, JSON.stringify(state));
        }

        function updateChecklistItemUI(id, checked) {
            const item = document.getElementById(`item-${id}`);
            if (!item) return;
            item.style.background = checked ? '#d4edda' : 'white';
        }

        function applyChecklistState() {
            const state = getChecklistState();
            const inputs = document.querySelectorAll('#checklistContainer input[type="checkbox"]');
            inputs.forEach(input => {
                const id = input.id.replace('check-', '');
                const checked = !!state[id];
                input.checked = checked;
                updateChecklistItemUI(id, checked);
            });
        }

        function renderSchedule() {
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0=DOM, 1=LUN, 2=MAR, 3=MI√â, 4=JUE, 5=VIE, 6=SAB
            const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;

            let schedule = [];

            if (isWeekend) {
                // S√ÅBADO Y DOMINGO
                const dayName = dayOfWeek === 6 ? 'S√ÅBADO' : 'DOMINGO';
                const isDomingo = dayOfWeek === 0;

                schedule = [
                    { time: '07:15-08:00', task: 'Rutina ma√±ana relajada (agua, luz, caf√©)', icon: '‚òÄÔ∏è' },
                    { time: '08:00-12:00', task: 'Tiempo libre ‚Ä¢ Hobbies ‚Ä¢ Leer ‚Ä¢ Pel√≠culas', icon: 'üé¨' },
                    { time: '12:00-13:30', task: 'Comida con calma', icon: 'üçΩÔ∏è' },
                    { time: '13:30-17:00', task: isDomingo ? 'üìã PLANIFICACI√ìN SEMANAL' : 'üéØ Planes personales', icon: isDomingo ? 'üìã' : 'üéØ' },
                    { time: '17:00-18:30', task: isDomingo ? 'Revisi√≥n semanal (15 min) + Relax' : 'Ejercicio O Viaje O Descanso', icon: isDomingo ? '‚úÖ' : 'üèÉ' },
                    { time: '18:30-20:00', task: 'Cena ‚Ä¢ Social ‚Ä¢ Familia', icon: 'üë•' },
                    { time: '20:00-21:30', task: 'Entretenimiento ‚Ä¢ Series ‚Ä¢ Lectura', icon: 'üìö' },
                    { time: '21:30', task: 'Duermes', icon: 'üò¥' }
                ];
            } else {
                // LUNES A VIERNES
                const dayName = ['', 'LUNES', 'MARTES', 'MI√âRCOLES', 'JUEVES', 'VIERNES'][dayOfWeek];
                const isExerciseDay = dayOfWeek === 1 || dayOfWeek === 3 || dayOfWeek === 5; // LUN, MI√â, VIE

                schedule = [
                    { time: '07:15-07:20', task: 'Agua + Luz solar', icon: 'üíß' },
                    { time: '07:20-07:30', task: 'Blinkist + Desayuno', icon: 'üìñ' },
                    { time: '09:00-18:30', task: 'Trabajo con Pomodoros (meta: 12+)', icon: 'üíº' },
                    { time: '18:30-19:15', task: isExerciseDay ? 'Ejercicio 40 min' : 'Relax ‚Ä¢ Paseo', icon: isExerciseDay ? 'üèãÔ∏è' : 'üö∂' },
                    { time: '19:15-20:00', task: 'Cena', icon: 'üçΩÔ∏è' },
                    { time: '21:00-21:30', task: 'Rutina nocturna', icon: 'üåô' },
                    { time: '21:30', task: 'Duermes (objetivo)', icon: 'üò¥' }
                ];
            }

            const container = document.getElementById('scheduleContainer');
            if (!container) return;

            container.innerHTML = schedule.map(item => `
                <div class="time-block">
                    <strong>${item.icon} ${item.time}</strong>
                    <em>${item.task}</em>
                </div>
            `).join('');
        }

        function toggleChecklistItem(id) {
            const checkbox = document.getElementById(`check-${id}`);
            if (!checkbox) return;

            const state = getChecklistState();
            state[id] = checkbox.checked;
            saveChecklistState(state);
            updateChecklistItemUI(id, checkbox.checked);
            autoSaveProgress();
        }

        function updatePomodoros() {
            const count = parseInt(localStorage.getItem(`pomodoros_${getTodayKey()}`) || 0);
            document.getElementById('pomodoroDisplay').textContent = count;
            document.getElementById('pomodoroProgress').textContent = `${count}/12`;
            updateProgressBars();
            autoSaveProgress();
        }

        function incrementPomodoro() {
            const today = getTodayKey();
            const current = parseInt(localStorage.getItem(`pomodoros_${today}`) || 0);
            const newValue = Math.min(current + 1, 20);
            localStorage.setItem(`pomodoros_${today}`, newValue);
            updatePomodoros();
        }

        function decrementPomodoro() {
            const today = getTodayKey();
            const current = parseInt(localStorage.getItem(`pomodoros_${today}`) || 0);
            const newValue = Math.max(current - 1, 0);
            localStorage.setItem(`pomodoros_${today}`, newValue);
            updatePomodoros();
        }

        function toggleMetric(metric) {
            const today = getTodayKey();
            const key = `${metric}_${today}`;
            const current = localStorage.getItem(key) === 'true';
            localStorage.setItem(key, !current);
            updateMetricDisplay(metric);
            updateProgressBars();
            autoSaveProgress();
        }

        function updateMetricDisplay(metric) {
            const today = getTodayKey();
            const value = localStorage.getItem(`${metric}_${today}`) === 'true';
            
            if (metric === 'exercise') {
                document.getElementById('exerciseDisplay').textContent = value ? '‚úÖ' : '‚ùå';
                document.getElementById('exerciseCard').style.background = value ? '#d4edda' : '#f5f5f7';
            } else if (metric === 'sleep') {
                document.getElementById('sleepDisplay').textContent = value ? '‚úÖ' : '‚ùå';
                document.getElementById('sleepCard').style.background = value ? '#d4edda' : '#f5f5f7';
            }
        }

        function updateProgressBars() {
            const today = getTodayKey();
            const exercise = localStorage.getItem(`exercise_${today}`) === 'true';
            const sleep = localStorage.getItem(`sleep_${today}`) === 'true';
            const pomodoros = parseInt(localStorage.getItem(`pomodoros_${today}`) || 0);

            // Barra pomodoros
            const pomodoroPercent = Math.min((pomodoros / 12) * 100, 100);
            document.getElementById('pomodoroBar').style.width = pomodoroPercent + '%';

            // Barra ejercicio
            document.getElementById('exerciseBar').style.width = exercise ? '100%' : '0%';

            // Barra sue√±o
            document.getElementById('sleepBar').style.width = sleep ? '100%' : '0%';
        }

        function getTodayKey() {
            const today = new Date();
            return today.toISOString().split('T')[0]; // YYYY-MM-DD
        }

        function autoSaveProgress() {
            // Auto-guarda sin mostrar alerta
            const today = getTodayKey();
            const exercise = localStorage.getItem(`exercise_${today}`) === 'true';
            const sleep = localStorage.getItem(`sleep_${today}`) === 'true';
            const pomodoros = parseInt(localStorage.getItem(`pomodoros_${today}`) || 0);
            const checklist = getChecklistState();
            const checklistCompleted = Object.values(checklist).filter(Boolean).length;
            const checklistTotal = document.querySelectorAll('#checklistContainer input[type="checkbox"]').length;
            
            const data = {
                date: today,
                exercise: exercise,
                pomodoros: pomodoros,
                sleep: sleep,
                checklist: checklist,
                checklistCompleted: checklistCompleted,
                checklistTotal: checklistTotal,
                timestamp: new Date().toISOString()
            };
            
            // Guarda datos consolidados
            localStorage.setItem(`progress_${today}`, JSON.stringify(data));
            localStorage.setItem('lastViewedDate', today);
            renderCalendarView();
        }

        function saveProgress() {
            autoSaveProgress();
            // Muestra feedback visual
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '‚úÖ ¬°Guardado!';
            setTimeout(() => {
                btn.textContent = originalText;
            }, 2000);
        }

        function loadProgress() {
            const today = getTodayKey();
            
            // Cargar pomodoros
            const pomodoros = parseInt(localStorage.getItem(`pomodoros_${today}`) || 0);
            document.getElementById('pomodoroDisplay').textContent = pomodoros;
            document.getElementById('pomodoroProgress').textContent = `${pomodoros}/12`;

            // Cargar m√©tricas
            updateMetricDisplay('exercise');
            updateMetricDisplay('sleep');
            updateProgressBars();
            applyChecklistState();
        }

        function getWeekHistory() {
            // Devuelve hist√≥rico de √∫ltimos 7 d√≠as
            const history = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const key = date.toISOString().split('T')[0];
                const data = localStorage.getItem(`progress_${key}`);
                history.push({
                    date: key,
                    dayName: date.toLocaleDateString('es-ES', { weekday: 'short' }),
                    data: data ? JSON.parse(data) : null
                });
            }
            return history;
        }

        // =========== REVISI√ìN SEMANAL ===========

        function getWeekNumber() {
            return getWeekNumberFromDate(new Date());
        }

        function getWeekNumberFromDate(date) {
            const start = new Date(date.getFullYear(), 0, 1);
            const diff = date - start;
            const oneWeek = 1000 * 60 * 60 * 24 * 7;
            return Math.floor(diff / oneWeek);
        }

        function getWeekDateRange() {
            const now = new Date();
            const first = now.getDate() - now.getDay() + 1; // Lunes
            const mondayDate = new Date(now.setDate(first));
            const sundayDate = new Date(now.setDate(first + 6));
            
            const mondayStr = mondayDate.toLocaleDateString('es-ES', { day: '2-digit', month: 'short' });
            const sundayStr = sundayDate.toLocaleDateString('es-ES', { day: '2-digit', month: 'short' });
            
            return `${mondayStr} - ${sundayStr}`;
        }

        function getWeekKey() {
            return getWeekKeyFromDate(new Date());
        }

        function getWeekKeyFromDate(date) {
            const week = getWeekNumberFromDate(date);
            const year = date.getFullYear();
            return `week_${year}_${week}`;
        }

        function saveWeeklyReview() {
            const weekKey = getWeekKey();
            const review = {
                date: new Date().toISOString(),
                exercise: document.querySelector('input[name="exercise"]:checked')?.value || '',
                pomodoros: document.querySelector('input[name="pomodoros"]:checked')?.value || '',
                sleep: document.querySelector('input[name="sleep"]:checked')?.value || '',
                notes: document.getElementById('weekNotes').value
            };
            
            localStorage.setItem(`review_${weekKey}`, JSON.stringify(review));
            showNotification('‚úÖ Revisi√≥n guardada!');
            renderReviewHistory();
        }

        // =========== GOOGLE CALENDAR INTEGRATION ===========

        function addToGoogleCalendar(type) {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            const dateStr = `${year}${month}${day}`;
            const nextDay = new Date(today);
            nextDay.setDate(today.getDate() + 1);
            const nextYear = nextDay.getFullYear();
            const nextMonth = String(nextDay.getMonth() + 1).padStart(2, '0');
            const nextDayStr = String(nextDay.getDate()).padStart(2, '0');
            const nextDateStr = `${nextYear}${nextMonth}${nextDayStr}`;

            let event = {};
            let endDateStr = dateStr;

            if (type === 'exercise') {
                const isMarked = document.getElementById('exerciseDisplay').textContent === '‚úÖ';
                if (!isMarked) {
                    alert('‚ö†Ô∏è Marca primero el ejercicio como completado.');
                    return;
                }
                event = {
                    title: 'Ejercicio 40 min',
                    startTime: '183000', // 18:30
                    endTime: '191500',   // 19:15
                    description: 'Calentamiento 5 min ‚Üí Ejercicio 30 min ‚Üí Estiramiento 5 min'
                };
            } else if (type === 'sleep') {
                const isMarked = document.getElementById('sleepDisplay').textContent === '‚úÖ';
                if (!isMarked) {
                    alert('‚ö†Ô∏è Marca primero el sue√±o como completado.');
                    return;
                }
                event = {
                    title: 'Dormir 7-8 horas',
                    startTime: '213000', // 21:30
                    endTime: '071500',   // 07:15 d√≠a siguiente
                    description: 'Rutina nocturna completada. Objetivo: 7-8 horas de sue√±o.'
                };
                endDateStr = nextDateStr;
            } else if (type === 'pomodoro') {
                const pomCount = parseInt(document.getElementById('pomodoroDisplay').textContent) || 0;
                if (pomCount === 0) {
                    alert('‚ö†Ô∏è Suma pomodoros antes de crear el evento.');
                    return;
                }
                event = {
                    title: `Pomodoros: ${pomCount}/12 completados`,
                    startTime: '090000', // 09:00
                    endTime: '183000',   // 18:30
                    description: `Sesiones completadas: ${pomCount} de 12 pomodoros de 15 min. Trabajo enfocado.`
                };
            } else if (type === 'routine') {
                event = {
                    title: 'Rutina Matinal 20 min',
                    startTime: '071500', // 07:15
                    endTime: '073500',   // 07:35
                    description: 'Agua + Lim√≥n (5 min) ‚Üí Blinkist (10 min) ‚Üí Desayuno (5 min)'
                };
            }

            if (!event.title) return;

            // Construir URL de Google Calendar
            const calendarUrl = `https://calendar.google.com/calendar/u/0/r/eventedit?text=${encodeURIComponent(event.title)}&dates=${dateStr}T${event.startTime}/${endDateStr}T${event.endTime}&details=${encodeURIComponent(event.description)}`;

            // Abrir en nueva ventana
            window.open(calendarUrl, '_blank');
            showNotification(`üìÖ Abriendo Google Calendar para "${event.title}"`);
        }


        function loadWeeklyReview() {
            const weekKey = getWeekKey();
            const saved = localStorage.getItem(`review_${weekKey}`);
            
            if (saved) {
                const review = JSON.parse(saved);
                
                // Cargar respuestas sin disparar eventos
                if (review.exercise) {
                    const el = document.getElementById(`ex-${review.exercise}`);
                    if (el) el.checked = true;
                }
                if (review.pomodoros) {
                    const el = document.getElementById(`pom-${review.pomodoros}`);
                    if (el) el.checked = true;
                }
                if (review.sleep) {
                    const el = document.getElementById(`sleep-${review.sleep}`);
                    if (el) el.checked = true;
                }
                
                // Cargar notas
                if (review.notes) {
                    document.getElementById('weekNotes').value = review.notes;
                }
            }
            
            // Mostrar rango de semana
            document.getElementById('weekRangeDisplay').textContent = getWeekDateRange();
            renderReviewHistory();
        }

        function renderReviewHistory() {
            const container = document.getElementById('reviewHistoryContainer');
            if (!container) return;

            // Obtener √∫ltimas 4 semanas usando la misma llave de semana
            const reviews = [];
            for (let i = 0; i < 4; i++) {
                const date = new Date();
                date.setDate(date.getDate() - (i * 7));
                const key = getWeekKeyFromDate(date);
                const saved = localStorage.getItem(`review_${key}`);
                
                if (saved) {
                    const review = JSON.parse(saved);
                    reviews.push({
                        date: new Date(review.date).toLocaleDateString('es-ES'),
                        exercise: review.exercise,
                        pomodoros: review.pomodoros,
                        sleep: review.sleep,
                        notes: review.notes
                    });
                }
            }

            if (reviews.length === 0) {
                container.innerHTML = '<p style="color: #999; text-align: center;">A√∫n no hay revisiones guardadas.</p>';
                return;
            }

            const getEmoji = (value) => {
                if (value === 'si') return '‚úÖ';
                if (value === 'casi' || value === 'parcial') return '‚ö†Ô∏è';
                if (value === 'no') return '‚ùå';
                return '‚Ä¢';
            };

            container.innerHTML = `
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    ${reviews.map((review, idx) => `
                        <div style="background: #f5f5f7; border-radius: 8px; padding: 12px; border-left: 4px solid #1d1d1d;">
                            <div style="font-weight: 600; margin-bottom: 8px; font-size: 13px;">${review.date}</div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 8px;">
                                <div style="text-align: center;">
                                    <div style="font-size: 20px;">${getEmoji(review.exercise)}</div>
                                    <div style="font-size: 11px; color: #666;">Ejercicio</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 20px;">${getEmoji(review.pomodoros)}</div>
                                    <div style="font-size: 11px; color: #666;">Pomodoros</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 20px;">${getEmoji(review.sleep)}</div>
                                    <div style="font-size: 11px; color: #666;">Sue√±o</div>
                                </div>
                            </div>
                            ${review.notes ? `<div style="font-size: 12px; color: #555; font-style: italic;">"${review.notes}"</div>` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Evento al cambiar de secci√≥n para recargar tracker
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('nav-tab')) {
                setTimeout(() => {
                    if (e.target.textContent.includes('Hoy')) {
                        initTracker();
                    }
                }, 100);
            }
        });

        // =========== SINCRONIZACI√ìN EN NUBE (URL) ===========

        function compressData(obj) {
            // Comprime datos a Base64
            const json = JSON.stringify(obj);
            return btoa(unescape(encodeURIComponent(json)));
        }

        function decompressData(encoded) {
            // Descomprime desde Base64
            try {
                const json = decodeURIComponent(escape(atob(encoded)));
                return JSON.parse(json);
            } catch (e) {
                console.error('Error decompressing data:', e);
                return null;
            }
        }

        function getAllData() {
            // Extrae TODOS los datos del localStorage
            const data = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                data[key] = localStorage.getItem(key);
            }
            return data;
        }

        function createShareLink() {
            // Crea un link compartible con todos los datos
            const allData = getAllData();
            const compressed = compressData(allData);
            const baseURL = window.location.origin + window.location.pathname;
            const shareLink = baseURL + '?data=' + compressed;
            
            // Copia al clipboard
            navigator.clipboard.writeText(shareLink).then(() => {
                // Muestra notificaci√≥n
                showNotification('‚úÖ Link copiado. Comparte con otros dispositivos o guarda.');
            }).catch(() => {
                // Si falla clipboard, muestra el link
                alert('Link de compartir:\n\n' + shareLink);
            });
        }

        function loadDataFromURL() {
            // Carga datos si vienen en la URL
            const params = new URLSearchParams(window.location.search);
            const compressedData = params.get('data');
            
            if (compressedData) {
                const decompressed = decompressData(compressedData);
                if (decompressed) {
                    // Carga TODOS los datos en localStorage
                    Object.keys(decompressed).forEach(key => {
                        localStorage.setItem(key, decompressed[key]);
                    });
                    
                    // Limpia la URL (quita el ?data=...)
                    window.history.replaceState({}, document.title, window.location.pathname);
                    
                    showNotification('üì• Datos importados correctamente!');
                    location.reload();
                }
            }
        }

        function downloadBackup() {
            // Descarga un archivo JSON de backup
            const allData = getAllData();
            const json = JSON.stringify(allData, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sistema-sergio-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showNotification('üì• Backup descargado!');
        }

        function uploadBackup() {
            // Permite importar un archivo JSON de backup
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        const data = JSON.parse(event.target.result);
                        Object.keys(data).forEach(key => {
                            localStorage.setItem(key, data[key]);
                        });
                        showNotification('‚úÖ Backup restaurado!');
                        location.reload();
                    } catch (error) {
                        alert('Error al cargar el archivo. Verifica que sea un JSON v√°lido.');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function showNotification(message) {
            // Muestra notificaci√≥n temporal
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.className = 'notification';
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>